@model IEnumerable<EMPManegment.EntityModels.View_Model.EmpDetailsView>
@using X.PagedList;
@using X.PagedList.Mvc.Core;
@inject EMPManegment.Web.Helper.Common CommonHelper

<div class="card">
    <div class="card-header">
        <form id="activeInactiveForm" style="margin-bottom: -20px;">
            <div class="row g-4 mb-3">
                <div class="row g-2 text-align">
                    <div class="col-lg-auto">
                        <a type="button" href="/UserProfile/UserActiveDecative" class="btn btn-warning btn-lg" id="backbtn">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                                <path fill="currentColor" d="m5.828 7l2.536 2.535L6.95 10.95L2 6l4.95-4.95l1.414 1.415L5.828 5H13a8 8 0 1 1 0 16H4v-2h9a6 6 0 0 0 0-12z" />
                            </svg>
                        </a>
                        <div class="btn-group">
                            <button class="btn btn-primary btn-lg dropdown-toggle" type="button" id="searchByDropdownButton" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Search By
                            </button>
                            <div class="dropdown-menu" aria-labelledby="searchByDropdownButton">
                                <a class="dropdown-item" href="#" data-value="ByUsername">Username</a>
                                <a class="dropdown-item" href="#" data-value="ByDepartment">Department</a>
                            </div>
                        </div>
                    </div>

                    <div class="col-sm" id="empnamebox">
                        <div class="search-box">
                            <input name="searchfor" class="form-control" id="txtsearchfor" aria-label="Search" autocomplete="off" />
                        </div>
                    </div>


                    <div class="col-lg-auto">
                        <button class="btn btn-success" type="button" onclick="BtnSearchDetails()" id="searchEmployeeform" value="Validate">
                            Search
                        </button>
                    </div>
                </div>
            </div>
        </form>
    </div>
    <div class="card-body" id="allemplist">
        <div class="row row-cols-xl-5 row-cols-lg-3 row-cols-md-2 row-cols-1" style="margin-top:20px;">
            @if (Model.Count() > 0)
            {
                @foreach (var item in Model)
                {
                    <div class="col" style="margin-left:60px;">
                        <div class="card">
                            <img src="~/assets/images/nft/img-03.jpg" alt="" class="object-fit-cover card-img-top" height="120">
                            <div class="card-body text-center">
                                <img src="~/@item.Image" alt="" class="avatar-md rounded-circle object-fit-cover mt-n5 img-thumbnail border-light mx-auto d-block" style="width:110px;height:80px;">
                                @if (item.IsActive == true)
                                {
                                    <a class="text-success" href="/UserProfile/DisplayUserDetails/?Id=@item.Id">
                                        <h5 class="mt-2 mb-1 fs-15">@item.FirstName @item.LastName</h5>
                                    </a>
                                }
                                else
                                {
                                    <a class="text-danger" href="/UserProfile/DisplayUserDetails/?Id=@item.Id">
                                        <h5 class="mt-2 mb-1 fs-15">@item.FirstName @item.LastName</h5>
                                    </a>
                                }

                                <p class="text-muted fs-14 mb-2">@item.UserName</p>
                                <p class="text-muted fs-14">
                                    Role:
                                    <span>
                                        <select id="ddlUserRole_@item.Id">
                                            <option value="@item.RoleId" selected>@item.RoleName</option>
                                        </select>
                                    </span>
                                </p>
                                <p class="text-muted fs-14">
                                    Dept:
                                    <span>
                                        <select id="ddlDepartment_@item.Id">
                                            <option value="@item.DepartmentId" selected>@item.DepartmentName</option>
                                        </select>
                                    </span>
                                </p>
                                <input type="hidden" value="@item.Id" id="txtUserId_@item.Id" />
                                <input type="hidden" value="@CommonHelper.GetCommonDateFormat(item.DateOfBirth)" id="txtDateOfBirth_@item.Id" />
                                <input type="hidden" value="@item.Gender" id="txtGender_@item.Id" />
                                <input type="hidden" value="@item.FirstName" id="txtFirstName_@item.Id" />
                                <input type="hidden" value="@item.LastName" id="txtLastName_@item.Id" />
                                <input type="hidden" value="@item.Email" id="txtEmail_@item.Id" />
                                <input type="hidden" value="@item.PhoneNumber" id="txtPhoneNumber_@item.Id" />
                                <input type="hidden" value="@item.Address" id="txtAddress_@item.Id" />
                                <form method="post">
                                    <div class="form-check form-switch text-center font-22">
                                        <input class="form-check-input" style="font-size:24px; margin-left:-30px;" type="checkbox" id="isAdd_@item.Id" name="isAdd" @(item.IsActive == true ? "checked" : "") onclick="UserActiveDeactive('@item.UserName', this)">
                                    </div>
                                    <br />
                                    <a href="#" class="btn btn-block btn-primary btn-lg" onclick="UpdateUserRoleAndDept('@item.Id');">Update</a>
                                </form>
                            </div>
                        </div>
                    </div>
                    <!--end col-->
                    <script>
                        $(document).ready(function () {
                            GetUserRoleList('@item.Id', '@item.RoleId');
                            GetDepartmentList('@item.Id', '@item.DepartmentId');
                        });
                    </script>
                }
            }

        </div>
        <!--end row-->
    </div>
    <!-- end card body -->
    <div id="activedeactivepagination">
        @Html.PagedListPager((IPagedList)Model, page => Url.Action("UserActiveDecative", new
            {
                page = page,
                searchfor = @Context.Request.Query["searchfor"],
                searchby = @Context.Request.Query["searchby"]
            }),
                 new X.PagedList.Web.Common.PagedListRenderOptions
        {
            LiElementClasses = new string[] { "page-item" },
            PageClasses = new string[] { "page-link" }
        })
    </div>

</div>
<!-- end card -->
