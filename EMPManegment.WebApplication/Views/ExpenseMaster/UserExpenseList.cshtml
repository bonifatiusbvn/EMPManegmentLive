@model List<EMPManegment.EntityModels.ViewModels.ExpenseMaster.ExpenseDetailsView>
@using EMPManegment.Web.Models
@inject IHttpContextAccessor Accessor;
@inject UserSession _userSession
@{
    ViewData["Title"] = "UserExpenseList";
    Layout = "~/Views/Shared/_UserHomeLayout.cshtml";
}

<input type="hidden" class="form-control" id="txtuserid" value="@_userSession.UserId" hidden>
<div class="row" style="margin-top:80px;">
    <div class="col-12">
        <div class="page-title-box d-sm-flex align-items-center justify-content-between">
            <h4 class="mb-sm-0">User Expense List</h4>
            <div class="page-title-right">
                <ol class="breadcrumb m-0">
                    <li class="breadcrumb-item"><a href="javascript: void(0);">User Expenses</a></li>
                    <li class="breadcrumb-item active">User Expenses</li>
                </ol>
            </div>
        </div>
    </div>
</div>
<!-- end page title -->
<!--New row-->
<div class="row">
    <div class="col-xxl-4 col-md-4">
        <div class="card card-animate">
            <div class="card-body">
                <div class="d-flex justify-content-between">
                    <div>
                        <p class="fw-medium text-muted mb-0">Credited Amount</p>
                        <h2 class="mt-4 ff-secondary fw-semibold text-success" id="txttotalcreditamount"><span class="counter-value"></span></h2>
                        <p class="mb-0 text-muted">
                        </p>
                    </div>
                    <div>
                        <div class="avatar-sm flex-shrink-0">
                            <span class="avatar-title bg-primary-subtle text-primary rounded-circle fs-4 text-success">
                                <i class="mdi mdi-trending-up align-middle me-1"></i>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--end col-->
    <div class="col-xxl-4 col-md-4">
        <div class="card card-animate">
            <div class="card-body">
                <div class="d-flex justify-content-between">
                    <div>
                        <p class="fw-medium text-muted mb-0">Debited Amount</p>
                        <h2 class="mt-4 ff-secondary fw-semibold text-danger" id="txttotaldebitedamount"><span class="counter-value"></span></h2>
                        <p class="mb-0 text-muted">
                        </p>
                    </div>
                    <div>
                        <div class="text-danger avatar-sm flex-shrink-0">
                            <span class="avatar-title bg-primary-subtle text-primary rounded-circle fs-4 text-danger">
                                <i class="mdi mdi-trending-down align-middle me-1"></i>
                            </span>
                        </div>
                    </div>
                </div>
            </div><!-- end card body -->
        </div> <!-- end card-->
    </div>
    <!--end col-->
    <div class="col-xxl-4 col-md-4">
        <div class="card card-animate">
            <div class="card-body bg-primary-subtle">
                <div class="d-flex justify-content-between">
                    <div class="flex-grow-1">
                        <h6 class="text-muted mb-0">Total Amount</h6>
                    </div>
                    <div class="avatar-sm flex-shrink-0">
                        <span class="avatar-title bg-primary-subtle text-primary rounded-circle fs-4 text-success border">
                            <i class="ri-ticket-2-line"></i>
                        </span>
                    </div>
                </div>
                <h3 class="mb-2 text-success" id="txtTotalAmount"></h3>
            </div>
        </div>
        <!--end swiper-->
    </div>
    <!--end col-->
</div>

<!--end row-->
<div class="row">
    <div class="col-lg-12">
        <div class="card" id="invoiceList">

            <div class="card-header">
                <div class="d-flex align-items-center">
                    <h5 class="card-title mb-0 flex-grow-1">My Expense-List</h5>
                    <div class="flex-shrink-0">
                        <div class="d-flex gap-2 flex-wrap">
                            <button class="btn btn-primary" id="remove-actions" style="margin-left:-34px;">
                                <i class="ri-delete-bin-2-line"></i>
                            </button>
                            <a class="btn btn-block btn-warning" onclick="DisplayAddExpenseModel()"><i class="ri-add-line align-bottom me-1"></i> Add Expense</a>
                        </div>
                    </div>
                </div>
            </div>
            <!--Edit Expense Modal -->
            <div class="modal fade zoomIn" id="EditExpenseModel" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class=" modal-dialog modal-dialog-centered modal-lg">
                    <div class="modal-content border-0">
                        <div class="modal-header bg-primary-subtle p-3">
                            <h5 class="modal-title" id="editModalLabel">Edit Expense Details</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <form id="EditExpenseForm">

                                <div class="row">
                                    <div class="col-lg-6">
                                        <div class="mb-3">
                                            <label for="txtexpensetype" class="form-label">Expense Type</label>
                                            <select class="form-control form-select valid" id="Editexpensetype" name="Editexpensetype">
                                                <option selected disabled value="">---Select Expense Type---</option>
                                            </select>
                                            <input type="hidden" class="text-muted text-uppercase fw-semibold" id="Editexpensetypeid" />
                                        </div>
                                    </div>
                                    <div class="col-lg-6">
                                        <div class="mb-3">
                                            <label class="form-label">Description</label>
                                            <input type="text" id="EditDescription" name="EditDescription" class="form-control" />
                                            <input type="hidden" id="Editid" class="form-control" name="txtid" />
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6">
                                        <div class="mb-3">
                                            <label class="form-label">Bill Number</label>
                                            <input type="text" id="Editbillno" name="Editbillno" class="form-control" />
                                        </div>
                                    </div>
                                    <div class="col-lg-6">
                                        <div class="mb-3">
                                            <label class="form-label">Date</label>
                                            <input type="datetime-local" id="Editdate" name="Editdate" class="form-control" />
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6">
                                        <div class="mb-3">
                                            <label class="form-label">Total Amount</label>
                                            <input type="text" id="Edittotalamount" name="Edittotalamount" class="form-control" />
                                        </div>
                                    </div>
                                    <div class="col-lg-6">
                                        <div class="mb-3">
                                            <label class="form-label">Account</label>
                                            <input class="form-control" id="Editaccount" name="Editaccount" readonly />
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6">
                                        <div class="mb-3">
                                            <label for="txtpaymenttype" class="form-label">Payment Type</label>
                                            <input class="form-control" id="Editpaymenttype" name="Editpaymenttype" readonly />
                                        </div>
                                    </div>
                                    <div class="col-lg-6">
                                        <div class="mb-3">
                                            <label class="form-label">IsPaid</label>
                                            <input class="form-control" id="EditIsPaid" name="EditIsPaid" readonly />
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6">
                                        <div class="mb-3">
                                            <label class="form-label">IsApproved</label>
                                            <input class="form-control" id="EditIsApproved" name="EditIsApproved" readonly />
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-danger btn-default m-1" id="close-modal" data-bs-dismiss="modal" onclick="ClearTextBox()">Close</button>
                            <button type="button" class="btn btn-success m-1" onclick="UpdateExpenseDetails()" id="updatedetailbtn">Update</button>

                        </div>
                    </div>
                </div>
            </div>
            <!--end Edit Expense modal-->

            <div class="card-body p-0">
                <div class="card-body">
                    <div id="example_wrapper" class="dataTables_wrapper dt-bootstrap5 no-footer">
                        <div class="col-sm-12">
                            <table id="UserExpenseTable" class="table table-bordered dt-responsive table-striped align-middle dataTable no-footer dtr-inline">
                                <thead class="table-light text-muted text-center">
                                    <tr>
                                        <th data-sort="name" scope="col" style="width: 60px;"></th>
                                        <th class="sort text-uppercase" data-sort="Description">
                                            Description
                                        </th>
                                        <th class="sort text-uppercase" data-sort="BillNo">BillNo</th>
                                        <th class="sort text-uppercase" data-sort="Date">Date</th>
                                        <th class="sort text-uppercase" data-sort="TotalAmount">TotalAmount</th>
                                        <th class="sort text-uppercase" data-sort="Account">
                                            Account
                                        </th>
                                        <th class="sort text-uppercase" data-sort="action">Action</th>
                                    </tr>
                                </thead>
                                <tbody class="list form-check-all text-center">
                                </tbody>
                            </table>
                            <!--end table-->
                        </div>
                        <div class="noresult" style="display: none">
                            <div class="text-center">
                                <lord-icon src="https://cdn.lordicon.com/msoeawqm.json" trigger="loop" colors="primary:#25a0e2,secondary:#00bd9d" style="width:75px;height:75px">
                                </lord-icon>
                                <h5 class="mt-2">Sorry! No Result Found</h5>
                                <p class="text-muted mb-0">
                                    We've searched more than 150+ transactions We did not find any
                                    transactions for you search.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Modal -->
        <div class="modal fade zoomIn" id="AddExpenseModel" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class=" modal-dialog modal-dialog-centered modal-lg">
                <div class="modal-content">
                    <div class="modal-header bg-primary-subtle p-3">
                        <h5 class="modal-title" id="exampleModalLabel">Add Expense Details</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form id="formexpensedetails">
                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="mb-3">
                                        <label for="txtexpensetype" class="form-label">Expense Type</label>
                                        <select class="form-control form-select valid" id="txtexpensetype" name="txtexpensetype">
                                            <option selected disabled value="">---Select Expense Type---</option>
                                        </select>
                                        <input type="hidden" class="text-muted text-uppercase fw-semibold" id="txtexpensetypeid">
                                        <input type="hidden" class="text-muted text-uppercase fw-semibold" id="txtaccount" value="Dabit">
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="mb-3">
                                        <label class="form-label">Description</label>
                                        <input type="text" id="txtDescription" class="form-control" name="txtDescription" placeholder="Enter Description" />
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="mb-3">
                                        <label class="form-label">Bill Number</label>
                                        <input type="text" id="txtbillno" class="form-control" name="txtbillno" placeholder="Enter Bill Number" />
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="mb-3">
                                        <label class="form-label">Date</label>
                                        <input type="date" id="txtdate" class="form-control" name="txtdate" placeholder="Enter Date" />
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="mb-3">
                                        <label class="form-label">Total Amount</label>
                                        <input type="text" id="txttotalamount" class="form-control" name="txttotalamount" placeholder="Enter Amount" />
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="mb-3">
                                        <label class="form-label">Image</label>
                                        <input type="file" id="txtimage" class="form-control" name="txtimage" placeholder="Enter Image" />
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger btn-default m-1" id="close-modal" data-bs-dismiss="modal" onclick="ClearTextBox()">Close</button>
                        <button type="submit" class="btn btn-success" onclick="AddUserExpenseDetails();" id="taskDetails" value="Validate">Save</button>
                    </div>
                </div>
            </div>
        </div>
        <!--end modal-->

    </div>
</div>
<!--end col-->
<!--end row-->
<style>
    #txtexpensetype-error, #txtDescription-error, #txtbillno-error,
    #txtdate-error, #txttotalamount-error, #txtimage-error,
    #txtaccount-error, #txtpaymenttype-error, #txtispaid-error, #txtisapproved-error {
        color: red;
    }

    #EditDescription-error, #Editbillno-error, #Edittotalamount-error {
        color: red;
    }

</style>
<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script src="~/moduls/expensemaster.js"></script>

